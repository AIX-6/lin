<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title id="pageTitle">ç¥ç§˜ç«‹å†¬ç¤¼ç‰©â„ï¸</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">
    <!-- åˆå§‹å¼¹çª— -->
    <div class="modal-backdrop" id="start-backdrop">
      <div class="modal">
        <div class="titlebar">
          <span id="festIcon">â„ï¸</span>
          <span id="festTitle">ç«‹å†¬å¿«ä¹</span>
        </div>
        <div class="content">æ‚¨æœ‰ä¸€ä»½<span id="giftWord">ç«‹å†¬</span>ç¤¼ç‰©ï¼Œç¡®å®šè¦æ‰“å¼€å—ï¼Ÿ</div>
        <div class="actions">
          <button class="btn primary" id="confirm-btn">ç¡®å®š</button>
        </div>
      </div>
    </div>
    <div id="popup-layer"></div>
  </div>

  <!-- æ— æ§ä»¶ã€éšè—çš„èƒŒæ™¯éŸ³é¢‘ -->
  <audio id="bgMusic" preload="auto" loop style="display:none;"></audio>

  <script>
  (() => {
    const GF_BDAY = '12-15'; // å¥¹ç”Ÿæ—¥
    const SOLAR_TERMS = {
      '02-04': ['ğŸŒ±','ç«‹æ˜¥å¿«ä¹'],'03-20': ['ğŸŒ¸','æ˜¥åˆ†å¿«ä¹'],'05-05': ['ğŸŒ¿','ç«‹å¤å¿«ä¹'],
      '06-21': ['â˜€ï¸','å¤è‡³å¿«ä¹'],'08-07': ['ğŸŒ¾','ç«‹ç§‹å¿«ä¹'],'09-23': ['ğŸ‚','ç§‹åˆ†å¿«ä¹'],
      '11-07': ['â„ï¸','ç«‹å†¬å¿«ä¹'],'12-21': ['â„ï¸','å†¬è‡³å¿«ä¹']
    };
    const ONE_DAY = {
      '02-14': ['ğŸ’˜','æƒ…äººèŠ‚å¿«ä¹'],'05-20': ['ğŸ’','520å¿«ä¹'],'07-07': ['ğŸŒŒ','ä¸ƒå¤•å¿«ä¹'],
      '10-31': ['ğŸƒ','ä¸‡åœ£èŠ‚å¿«ä¹'],'12-24': ['ğŸ…','å¹³å®‰å¤œå¿«ä¹'],'12-25': ['ğŸ„','åœ£è¯èŠ‚å¿«ä¹']
    };

    const pad = n => String(n).padStart(2,'0');
    const fmt = (m, d) => `${pad(m)}-${pad(d)}`;
    const today = new Date();
    const todayKey = fmt(today.getMonth() + 1, today.getDate());

    // è®¡ç®—ã€ŒYYYYå¹´MæœˆDæ—¥ æ˜ŸæœŸXã€
    const week = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'];
    const dateStr = `${today.getFullYear()}å¹´${today.getMonth()+1}æœˆ${today.getDate()}æ—¥ æ˜ŸæœŸ${week[today.getDay()]}`;

    // é»˜è®¤é…ç½®ï¼ˆéèŠ‚æ—¥ï¼‰
    const DEFAULT = [
      'ğŸ“…',
      dateStr + ' ä»Šå¤©ä¹Ÿè¦å¼€å¿ƒå“¦',
      '2025.11.7.mp3',
      dateStr + ' ç¥ç§˜æƒŠå–œç¤¼ç‰©ğŸ“…',
      'æƒŠå–œ'
    ];

    function festPack() {
      if (todayKey === GF_BDAY) return ['ğŸ‚','å®è´ç”Ÿæ—¥å¿«ä¹','2025.11.7.mp3','ç¥ç§˜ç”Ÿæ—¥æƒŠå–œğŸ‚','ç”Ÿæ—¥'];
      for (let [k,v] of Object.entries(SOLAR_TERMS)) {
        const base = new Date(today.getFullYear(), Number(k.slice(0,2))-1, Number(k.slice(3)));
        for (let i=0;i<3;i++){ const cur=new Date(base); cur.setDate(base.getDate()+i);
          if (fmt(cur.getMonth()+1,cur.getDate())===todayKey) return [v[0],v[1],'2025.11.7.mp3',`ç¥ç§˜${v[1]}${v[0]}`,v[1].slice(0,2)]; }
      }
      if (ONE_DAY[todayKey]) return [ONE_DAY[todayKey][0],ONE_DAY[todayKey][1],'2025.11.7.mp3',`ç¥ç§˜${ONE_DAY[todayKey][1]}${ONE_DAY[todayKey][0]}`,ONE_DAY[todayKey][1].slice(0,2)];
      return DEFAULT;
    }

    const [icon,title,bgmFile,pageTitle,giftWord] = festPack();
    document.getElementById('festIcon').textContent  = icon;
    document.getElementById('festTitle').textContent = title;
    document.getElementById('pageTitle').textContent = pageTitle;
    document.getElementById('giftWord').textContent  = giftWord;
    document.getElementById('bgMusic').src = bgmFile;

    // å¼¹å¹•æ–‡æ¡ˆ
    const msgs = [
      // ç‹è€…
      'ä»Šå¤©æ’ä½ä¸è¿è·ªï¼','è®°å¾—banæ‰ä¸œçš‡~','è®°å¾—èººå¥½ï¼Œä¸è¦æ‰é˜Ÿ~','mvp é¢„å®š','é‡åŒºæˆ‘æ‰¿åŒ…äº†',
      'å…µçº¿åˆ«æ¼æ‰','ç‰›å•Šï¼Œç‰›å•Š','ä¼˜åŠ¿åˆ«ä¸Šå¤´','é€†é£ç¨³ä½','æ—©ç‚¹ç¡ï¼Œåˆ«é€šå®µå¼€é»‘',
      // æ—¥å¸¸
      'ä»Šå¤©å–å¤Ÿæ°´äº†å—','åˆé¤æƒ³åƒå•¥','æ™šéœæ‹ç…§äº†å—','æ­Œå•è¯¥æ›´æ–°äº†','å¿«é€’åˆ°äº†è®°å¾—å–',
      'æ˜æ—©åˆ«è¿Ÿåˆ°å“¦','ç©ºè°ƒæ¸©åº¦åˆ«å¤ªä½','æ–°ä¸Šçš„å‰§çœ‹äº†å—','å¥¶èŒ¶ä¸‰åˆ†ç³–åˆšå¥½','æ™šå®‰ï¼Œå¥½æ¢¦'
    ];

    const themes = ['theme-blue','theme-green','theme-purple','theme-orange','theme-pink'];
    const anims = ['anim-bottom','anim-top','anim-left','anim-right'];
    const layer = document.getElementById('popup-layer');
    function rand(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    let count = 0;
    const total = 200;   // 20ç§’Ã—10ä¸ª/ç§’
    const interval = 100; // 100ms

    function addOne(){
      const {innerWidth:w,innerHeight:h} = window;
      const div = document.createElement('div');
      div.className = `popup ${rand(themes)} ${rand(anims)}`;
      div.innerHTML = `
        <div class="header"><span class="icon">ğŸ’</span><span class="title">æç¤º</span></div>
        <div class="content">${rand(msgs)}</div>
      `;
      div.style.left = Math.random() * Math.max(0, w - 230) + 'px';
      div.style.top  = Math.random() * Math.max(0, h - 100) + 'px';
      layer.appendChild(div);
      count++;
      if (count < total) setTimeout(addOne, interval);
    }

    document.getElementById('confirm-btn').addEventListener('click', () => {
      document.getElementById('start-backdrop').style.display = 'none';

      const audio = document.getElementById('bgMusic');

      // ç”¨æˆ·æ‰‹åŠ¿åï¼šå…ˆå¼ºåˆ¶åŠ è½½ï¼Œå†æ’­æ”¾ï¼Œé¿å…ä»»ä½•è‡ªåŠ¨æ’­æ”¾æ‹¦æˆª
      audio.load();                                    // é‡æ–°è§£ææ–‡ä»¶
      audio.play().catch(err => console.log('æ’­æ”¾å¤±è´¥:', err));

      addOne();
    }, {once:true});
  })();
  </script>
</body>
</html>